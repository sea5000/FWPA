<!DOCTYPE html>
<html lang="en">
  <head>
    <meta
      name="generator"
      content="HTML Tidy for HTML5 for Linux version 5.6.0"
    />
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <title>Bookme - Streak</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="styles.css" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800&amp;display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: 'Plus Jakarta Sans', sans-serif;
      }
    </style>
  </head>
  <body class="bg-light text-dark">
    <div class="d-flex flex-column min-vh-100">
      <header class="w-100 site-header">
        <div
          class="container d-flex align-items-center justify-content-between py-3"
        >
          <div class="d-flex align-items-center">
            <div class="me-2" style="width:40px;height:40px;color:var(--bs-primary);">
              <span class="material-symbols-outlined fs-3 text-primary">book</span>
            </div>
            <h1 class="h5 mb-0 ms-2">Bookme</h1>
          </div>
          <nav class="nav-centered d-none d-md-flex align-items-center gap-2">
            <a class="btn btn-sm btn-light rounded-pill" href="../dashboard/index.html">Home</a>
            <a class="btn btn-sm btn-primary rounded-pill text-white" href="../study/index.html">Study</a>
            <a class="btn btn-sm btn-light rounded-pill" href="../community/index.html">Community</a>
            <a class="btn btn-sm btn-light rounded-pill" href="../challenges/index.html">Challenge</a>
          </nav>
          <div class="d-none d-md-flex align-items-center header-actions">
            <button
              type="button"
              class="btn btn-link text-muted p-0"
              aria-label="Notifications"
              title="Notifications"
            >
              <span class="material-symbols-outlined">notifications</span>
            </button>
            <a href="../profile&settings/index.html" class="btn btn-link text-muted p-0" aria-label="Profile" title="Profile">
                        <span class="material-symbols-outlined fs-3">account_circle</span>
                    </a>
          </div>
        </div>
      </header>

      <main class="container py-5">
        <div class="streak-container">
          <h2 class="fw-bold mb-3">Your Study Streak & contributions</h2>
          <div class="card p-3">
            <div class="month-labels" id="month-labels"></div>
            <div class="d-flex gap-2">
              <div class="weekday-labels">
                <div></div>
                <div>Mon</div>
                <div></div>
                <div>Wed</div>
                <div></div>
                <div>Fri</div>
                <div></div>
              </div>
              <div class="streak-grid" id="streak-grid">
                <!-- Days will be generated by JS -->
              </div>
            </div>
          </div>
          <div class="streak-legend">
            <span>Less</span>
            <div class="streak-day" data-level="0"></div>
            <div class="streak-day" data-level="1"></div>
            <div class="streak-day" data-level="2"></div>
            <div class="streak-day" data-level="3"></div>
            <div class="streak-day" data-level="4"></div>
            <span>More</span>
          </div>
        </div>

        <!-- gif section -->
        <div class="motivational-section text-center mt-4">
          <img src="https://i.pinimg.com/originals/d5/f5/ae/d5f5ae2e743118a375986e0bb292f1a2.gif"
               alt="Motivational celebration gif"
               class="motivational-gif mb-3" />
          <div class="motivational-message">
            <p class="h6 text-primary fw-bold mb-1">You're doing amazing!</p>
            <p class="text-muted small">Remember why you're doing this âœ© every small step counts toward your goals. Keep up the great work! ðŸŒŸ</p>
          </div>
        </div>
      </main>

      <footer class="d-md-none fixed-bottom bg-white border-top">
        <nav class="nav justify-content-around py-2">
          <a
            class="nav-link d-flex flex-column align-items-center text-primary fw-bold"
            href="../home/index.html"
            ><span class="material-symbols-outlined fs-4">home</span>
            <small class="d-block">Home</small></a
          >
          <a
            class="nav-link d-flex flex-column align-items-center text-muted"
            href="../study/index.html"
            ><span class="material-symbols-outlined fs-4">school</span>
            <small class="d-block">Study</small></a
          >
          <a
            class="nav-link d-flex flex-column align-items-center text-muted"
            href="../community/index.html"
            ><span class="material-symbols-outlined fs-4">groups</span>
            <small class="d-block">Community</small></a
          >
          <a
            class="nav-link d-flex flex-column align-items-center text-muted"
            href="../challenges/index.html"
            ><span class="material-symbols-outlined fs-4">emoji_events</span>
            <small class="d-block">Challenge</small></a
          >
        </nav>
      </footer>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const grid = document.getElementById("streak-grid");
        const monthLabelsContainer = document.getElementById("month-labels");
        const today = new Date();
        const daysInGrid = 371; // 53 weeks * 7 days

        //generate random data
        let studyData = JSON.parse(localStorage.getItem("studyData")) || {};
        if (Object.keys(studyData).length === 0) {
          for (let i = 0; i < daysInGrid; i++) {
            const date = new Date();
            date.setDate(today.getDate() - i);
            if (Math.random() > 0.4) {
              // 60% chance of having data for a day
              studyData[date.toLocaleDateString()] = Math.floor(
                Math.random() * 120
              ); // 0-120 minutes
            }
          }
          localStorage.setItem("studyData", JSON.stringify(studyData));
        }

        function getLevel(minutes) {
          if (minutes === 0) return 0;
          if (minutes <= 15) return 1;
          if (minutes <= 45) return 2;
          if (minutes <= 90) return 3;
          return 4;
        }

        const monthLabels = [
          "Jan",
          "Feb",
          "Mar",
          "Apr",
          "May",
          "Jun",
          "Jul",
          "Aug",
          "Sep",
          "Oct",
          "Nov",
          "Dec",
        ];
        const visibleMonths = new Array(12).fill(0);

        for (let i = 0; i < daysInGrid; i++) {
          const date = new Date();
          date.setDate(today.getDate() - (daysInGrid - 1 - i));
          const minutes = studyData[date.toLocaleDateString()] || 0;
          const level = getLevel(minutes);

          const day = document.createElement("div");
          day.className = "streak-day";
          day.dataset.level = level;
          day.title = `${date.toDateString()}: ${minutes} minutes`;
          grid.appendChild(day);

          // For month labels
          if (date.getDate() === 1) {
            visibleMonths[date.getMonth()]++;
          }
        }

        let lastMonth = -1;
        for (let i = 0; i < 53; i++) {
          const date = new Date();
          date.setDate(today.getDate() - (daysInGrid - 1) + i * 7);
          const month = date.getMonth();
          if (month !== lastMonth) {
            const label = document.createElement("div");
            label.textContent = monthLabels[month];
            label.style.gridColumn = i + 1;
            monthLabelsContainer.appendChild(label);
            lastMonth = month;
          }
        }

        const tooltipTriggerList = [].slice.call(
          document.querySelectorAll("[title]")
        );
        tooltipTriggerList.map(function (tooltipTriggerEl) {
          return new bootstrap.Tooltip(tooltipTriggerEl);
        });
      });
    </script>
  </body>
</html>
